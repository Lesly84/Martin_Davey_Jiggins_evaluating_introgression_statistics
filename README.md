This repository contains code and data for the manuscript "Evaluating statistics for the identification of introgressed loci" by Simon H. Martin, John W. Davey and Chris D. Jiggins, available on bioRxiv.

The results in the paper were generated as follows.

Models are generated using the `shared_ancestry_simulator.R` script. A single combined model can be generated like this:

```
./shared_ancestry_simulator.R -w 10000 -T 60 -c Alternate_t123-0.4_t23-0.2.yml:0.1,Background_t123-0.6_t21-0.4.yml:0.9
```

This will generate 10000 windows, 10% of which will be generated using the model described in the file `Alternate_t123-0.4_t23-0.2.yml` and 90% of which will be generated using `Background_t123-0.6_t21-0.4.yml`, using 60 threads. See the model files folders for the YAML files generated for this paper.

These YAML files were generated by the `run_model_combinations.pl` script, using the following commands for the 5kb, 10kb and 20kb simulations:

```
./run_model_combinations.pl -T 60 -n 10000 -w 5000 -p 1000000 -m Model_parameter_list.csv
./run_model_combinations.pl -T 60 -n 5000 -w 10000 -p 1000000 -m Model_parameter_list.csv
./run_model_combinations.pl -T 60 -n 2500 -w 20000 -p 1000000 -m Model_parameter_list.csv -s path/to/simulator
```

Option 'p' defines the effective population size and option 'm' specifies a file containing the list of models to simulate (available in the repository). Option 's' is the directory path to the simulator script, `shared_ancestry_simulator.R`. If 's' is not provided, `run_model_combinations.pl` assumes `shared_ancestry_simulator.R` is in the same folder as itself.

Summary statistics for the models found in the `partition.summary` and `dxy.summary` files were generated as follows:

```
./generate_summary_statistics.R -m model_files_win10000_size5000 -T 60
./generate_summary_statistics.R -m model_files_win5000_size10000 -T 60
./generate_summary_statistics.R -m model_files_win2500_size20000 -T 60
```

Real data for the Heliconius genome, split into 5 kb windows, can be found in the file `Heliconius_genome_windows.csv`.

The figures were generated using these summary statistics files, using the following scripts:

```
./Figure_2.R -i model_files_win10000_size5000/Alternate_t123-1.2_t23-0.2.Background_t123-2_t21-1.2.10000.csv
./Figure_6_S5.R
./Figure_7.R -i model_files_win10000_size5000.dxy.summary.tsv
./Figure_S1_S2.R -i model_files_win10000_size5000.partition.summary.tsv
./Figure_S3_S4.R
```